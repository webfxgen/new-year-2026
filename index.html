<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy New Year 2026 - Interactive Celebration</title>
    <style>
        /* Mobile-first, responsive design */
        body { margin: 0; overflow: hidden; background-color: #000000; font-family: 'Cinzel', serif, sans-serif; }
        canvas { display: block; outline: none; position: absolute; top: 0; left: 0; z-index: 1; }
        
        /* Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Montserrat:wght@400;700&display=swap');

        /* UI Overlay */
        #ui-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            padding: 20px;
            box-sizing: border-box;
        }

        .ui-element {
            pointer-events: auto;
            transition: opacity 0.5s, transform 0.5s;
            text-align: center;
            width: 100%;
            max-width: 600px;
        }

        /* Titles */
        h1 {
            color: #d4af37; /* Gold */
            text-shadow: 0 0 20px #ffd700, 0 0 40px #ff8c00;
            font-size: clamp(2.5rem, 8vw, 5rem);
            margin-bottom: 10px;
            font-family: 'Cinzel', serif;
            letter-spacing: 2px;
        }

        /* The Big Year Number */
        #year-display {
            font-size: clamp(4rem, 15vw, 8rem);
            color: #fff;
            text-shadow: 0 0 10px #fff, 0 0 20px #d4af37;
            margin: 0;
            line-height: 1;
            font-family: 'Cinzel', serif;
            opacity: 0; /* Hidden initially */
            transform: scale(0.5);
            transition: all 1s ease-out;
        }

        p.subtitle {
            color: #e0e0e0;
            font-size: clamp(1rem, 4vw, 1.5rem);
            margin-bottom: 30px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            font-family: 'Montserrat', sans-serif;
        }

        /* Countdown Timer */
        #countdown-timer {
            font-size: clamp(3rem, 10vw, 6rem);
            color: #ff4d4d;
            font-weight: bold;
            text-shadow: 0 0 20px #ff0000;
            font-family: 'Montserrat', sans-serif;
            margin: 20px 0;
        }

        /* Buttons */
        button {
            background: linear-gradient(135deg, #d4af37, #f7ef8a, #d4af37);
            border: 2px solid #fff;
            border-radius: 50px;
            padding: clamp(15px, 4vw, 20px) clamp(40px, 8vw, 60px);
            color: #000;
            font-size: clamp(1rem, 3.5vw, 1.3rem);
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.6);
            transition: all 0.3s ease;
            font-family: 'Cinzel', serif;
            letter-spacing: 1px;
            outline: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            text-transform: uppercase;
            margin: 10px;
        }

        button:active { transform: scale(0.95); }
        button:hover { 
            box-shadow: 0 0 40px rgba(212, 175, 55, 1); 
            transform: translateY(-3px);
            background: linear-gradient(135deg, #fff, #d4af37);
        }

        /* Unique style for Popper button */
        #btn-pull-popper {
            background: linear-gradient(135deg, #ff00cc, #3333ff);
            color: #fff;
            border: 2px solid #fff;
            box-shadow: 0 0 25px rgba(255, 0, 204, 0.6);
        }
        #btn-pull-popper:hover {
            box-shadow: 0 0 40px rgba(255, 0, 204, 1); 
        }

        .share-btn {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            margin-top: 20px;
            color: white;
            border-color: transparent;
        }

        /* Card */
        #card-content {
            display: none;
            background: rgba(10, 10, 20, 0.9);
            padding: clamp(30px, 6vw, 50px);
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            color: #fff;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.3);
            opacity: 0;
            transform: translateY(20px) scale(0.9);
            border: 2px solid #d4af37;
            margin: 0 auto;
        }

        #card-content h2 {
            color: #d4af37;
            margin: 0 0 20px 0;
            font-family: 'Cinzel', serif;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
        }

        #card-content p { 
            font-size: clamp(1rem, 4vw, 1.2rem);
            line-height: 1.6; 
            font-family: 'Montserrat', sans-serif;
            color: #ddd;
        }

        .hidden { 
            opacity: 0 !important; 
            pointer-events: none !important; 
            display: none !important;
        }

        /* Footer */
        footer {
            position: absolute;
            bottom: 10px;
            width: 100%;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.8rem;
            pointer-events: auto;
            z-index: 20;
        }
        
        footer a {
            color: #d4af37;
            text-decoration: none;
            font-weight: bold;
        }
        
        footer a:hover {
            text-decoration: underline;
            color: #fff;
        }

        /* Loading Screen */
        #loading {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 20;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #d4af37;
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            transition: opacity 0.5s;
        }
        
    </style>
</head>
<body>

    <!-- Festive Audio -->
    <audio id="bg-music" src="https://assets.mixkit.co/music/preview/mixkit-fireworks-celebration-2965.mp3" loop></audio>
    <audio id="pop-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-cork-pop-glass-clink-1718.mp3"></audio>
    <audio id="firework-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-fireworks-explosion-1692.mp3"></audio>
    <audio id="popper-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-party-popper-exploding-2007.mp3"></audio>

    <!-- Loading -->
    <div id="loading">Preparing the Party...</div>

    <div id="ui-container">
        <!-- Step 1: Welcome -->
        <div id="step-1" class="ui-element" style="display: none;">
            <h1>New Year's Eve</h1>
            <p class="subtitle">The countdown is about to begin...</p>
            <button id="btn-start">Enter the Party ü•Ç</button>
        </div>

        <!-- Step 2: Champagne -->
        <div id="step-2" class="ui-element hidden">
            <h1>Let's Toast!</h1>
            <button id="btn-champagne">Pop the Champagne üçæ</button>
        </div>

        <!-- Step 3: Popper (NEW) -->
        <div id="step-popper" class="ui-element hidden">
            <h1>Make it Rain!</h1>
            <button id="btn-pull-popper">Pull the Popper üéâ</button>
        </div>

        <!-- Step 4: Countdown -->
        <div id="step-4" class="ui-element hidden">
            <p class="subtitle" style="font-size: 1.5rem;">Ready?</p>
            <div id="countdown-timer">10</div>
            <button id="btn-countdown">Start Countdown ‚è≥</button>
        </div>

        <!-- Step 5: Celebration & Message -->
        <div id="final-screen" class="ui-element hidden">
            <h1 id="year-display">2026</h1>
            <div id="card-content">
                <h2>Happy New Year!</h2>
                <p>
                    May this new year bring you endless opportunities, 
                    boundless joy, and the courage to chase your dreams.
                    Here's to a fresh start and a brighter future!
                </p>
                <p style="font-weight: bold; margin-top: 20px; font-size: 1.5rem;">ü•Ç‚ú®üéÜ</p>
            </div>
            
            <button id="btn-share" class="share-btn">Share the Celebration üì§</button>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        Made with ‚ù§Ô∏è by <a href="https://www.webfxgen.in" target="_blank">www.webfxgen.in</a>
    </footer>

    <!-- Libraries (Standard Global Scripts - Most Reliable) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        // Use a self-executing function to avoid global scope pollution issues, but access globals THREE and gsap
        (function() {
            
            // --- 1. SCENE SETUP ---
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x020204);
            scene.fog = new THREE.FogExp2(0x020204, 0.02);

            const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 15);

            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.body.appendChild(renderer.domElement);

            // --- 2. OBJECTS ---

            // Starfield
            const starGeo = new THREE.BufferGeometry();
            const starCount = 2000;
            const starPos = new Float32Array(starCount * 3);
            for(let i=0; i<starCount*3; i++) {
                starPos[i] = (Math.random() - 0.5) * 100;
            }
            starGeo.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
            const starMat = new THREE.PointsMaterial({color: 0xffffff, size: 0.1, transparent: true});
            const stars = new THREE.Points(starGeo, starMat);
            scene.add(stars);

            // Disco Ball (The Centerpiece)
            const discoGroup = new THREE.Group();
            scene.add(discoGroup);
            discoGroup.visible = false;

            // Core Sphere
            const ballGeo = new THREE.SphereGeometry(2.5, 32, 32);
            const ballMat = new THREE.MeshPhongMaterial({ 
                color: 0x222222, 
                emissive: 0x111111,
                specular: 0xffffff,
                shininess: 100,
                flatShading: true 
            });
            const discoBall = new THREE.Mesh(ballGeo, ballMat);
            discoGroup.add(discoBall);

            // Add "Mirrors" (Particles on surface)
            const mirrorGeo = new THREE.BufferGeometry();
            const mirrorCount = 1000;
            const mirrorPos = [];
            const mirrorColors = [];
            const colorPalette = [0xd4af37, 0xc0c0c0, 0x00ffff, 0xff00ff]; // Gold, Silver, Cyan, Magenta

            for(let i=0; i<mirrorCount; i++) {
                // Random point on sphere surface
                const phi = Math.acos(-1 + (2 * i) / mirrorCount);
                const theta = Math.sqrt(mirrorCount * Math.PI) * phi;
                
                const r = 2.6; // Slightly larger than ball
                const x = r * Math.cos(theta) * Math.sin(phi);
                const y = r * Math.sin(theta) * Math.sin(phi);
                const z = r * Math.cos(phi);
                
                mirrorPos.push(x, y, z);
                
                const c = new THREE.Color(colorPalette[Math.floor(Math.random() * colorPalette.length)]);
                mirrorColors.push(c.r, c.g, c.b);
            }
            mirrorGeo.setAttribute('position', new THREE.Float32BufferAttribute(mirrorPos, 3));
            mirrorGeo.setAttribute('color', new THREE.Float32BufferAttribute(mirrorColors, 3));
            
            const mirrorMat = new THREE.PointsMaterial({ size: 0.15, vertexColors: true, blending: THREE.AdditiveBlending });
            const mirrors = new THREE.Points(mirrorGeo, mirrorMat);
            discoGroup.add(mirrors);

            // Lights pointing at disco ball
            const spot1 = new THREE.SpotLight(0xff0000, 2);
            spot1.position.set(10, 10, 10);
            spot1.lookAt(0,0,0);
            scene.add(spot1);

            const spot2 = new THREE.SpotLight(0x0000ff, 2);
            spot2.position.set(-10, -10, 10);
            spot2.lookAt(0,0,0);
            scene.add(spot2);

            // Champagne Particles
            const bubblesGroup = new THREE.Group();
            scene.add(bubblesGroup);
            const bubbles = [];
            const bubbleGeo = new THREE.SphereGeometry(0.1, 8, 8);
            const bubbleMat = new THREE.MeshBasicMaterial({ color: 0xffeaab, transparent: true, opacity: 0.8 });

            // Confetti / Party Popper System
            const confettiGroup = new THREE.Group();
            scene.add(confettiGroup);
            const confettis = [];
            const confettiColors = [0xff0000, 0x00ff00, 0x0000ff, 0xffff00, 0xff00ff, 0x00ffff];

            function triggerPopper() {
                // Play Sound
                const audio = document.getElementById('popper-sound').cloneNode();
                audio.volume = 0.8;
                audio.play().catch(()=>{});

                const particleCount = 200; // Lots of confetti!
                const geometry = new THREE.PlaneGeometry(0.15, 0.3); // Rectangular confetti

                for(let i=0; i<particleCount; i++) {
                    const material = new THREE.MeshBasicMaterial({ 
                        color: confettiColors[Math.floor(Math.random() * confettiColors.length)],
                        side: THREE.DoubleSide
                    });
                    const mesh = new THREE.Mesh(geometry, material);
                    
                    // Start from center screen
                    mesh.position.set(0, 0, 8); 
                    
                    confettiGroup.add(mesh);

                    // Explosion velocity - Burst outward
                    const angle = Math.random() * Math.PI * 2;
                    const speed = 0.2 + Math.random() * 0.5;
                    const spread = 2.0;

                    confettis.push({
                        mesh: mesh,
                        vel: new THREE.Vector3(
                            (Math.random() - 0.5) * spread,
                            (Math.random() - 0.5) * spread + 0.5, // Bias upwards
                            (Math.random() - 0.5) * spread
                        ),
                        rotVel: new THREE.Vector3(
                            Math.random() * 0.2,
                            Math.random() * 0.2,
                            Math.random() * 0.2
                        ),
                        life: 3.0 // Lasts longer
                    });
                }
            }

            // Fireworks System
            const fireworks = [];

            function createFirework() {
                const fwColor = new THREE.Color().setHSL(Math.random(), 1, 0.5);
                const particleCount = 150;
                const geo = new THREE.BufferGeometry();
                const pos = [];
                const vel = [];
                
                const startX = (Math.random() - 0.5) * 20;
                const startY = (Math.random() - 0.5) * 10;
                const startZ = (Math.random() - 0.5) * 10 - 5;

                for(let i=0; i<particleCount; i++) {
                    pos.push(startX, startY, startZ);
                    
                    // Sphere explosion
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.acos(Math.random() * 2 - 1);
                    const speed = 0.2 + Math.random() * 0.3;

                    vel.push(
                        speed * Math.sin(phi) * Math.cos(theta),
                        speed * Math.sin(phi) * Math.sin(theta),
                        speed * Math.cos(phi)
                    );
                }

                geo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
                const mat = new THREE.PointsMaterial({ size: 0.2, color: fwColor, transparent: true, blending: THREE.AdditiveBlending });
                const mesh = new THREE.Points(geo, mat);
                scene.add(mesh);

                fireworks.push({ mesh: mesh, vel: vel, life: 1.0 });
                
                // Play sound occasionally
                if(Math.random() > 0.5) {
                    const audio = document.getElementById('firework-sound').cloneNode();
                    audio.volume = 0.3;
                    audio.play().catch(()=>{});
                }
            }

            // --- 3. ANIMATION LOOP ---
            function animate() {
                requestAnimationFrame(animate);

                // 1. Rotate Background Stars
                stars.rotation.y += 0.0005;

                // 2. Rotate Disco Ball
                if(discoGroup.visible) {
                    discoGroup.rotation.y += 0.01;
                    discoGroup.rotation.z += 0.005;
                    // Move lights slightly
                    spot1.position.x = Math.sin(Date.now() * 0.001) * 15;
                    spot2.position.y = Math.cos(Date.now() * 0.001) * 15;
                }

                // 3. Animate Bubbles (Champagne)
                for (let i = bubbles.length - 1; i >= 0; i--) {
                    const b = bubbles[i];
                    b.mesh.position.add(b.velocity);
                    b.velocity.y -= 0.005; // Gravity
                    b.life -= 0.01;
                    b.mesh.material.opacity = b.life;
                    if(b.life <= 0) {
                        bubblesGroup.remove(b.mesh);
                        bubbles.splice(i, 1);
                    }
                }

                // 4. Animate Confetti
                for(let i = confettis.length - 1; i >= 0; i--) {
                    const c = confettis[i];
                    c.mesh.position.add(c.vel);
                    c.mesh.rotation.x += c.rotVel.x;
                    c.mesh.rotation.y += c.rotVel.y;
                    c.mesh.rotation.z += c.rotVel.z;
                    
                    // Gravity and Drag
                    c.vel.y -= 0.005; 
                    c.vel.x *= 0.98;
                    c.vel.z *= 0.98;

                    c.life -= 0.01;
                    if(c.life <= 0) {
                        confettiGroup.remove(c.mesh);
                        confettis.splice(i, 1);
                    }
                }

                // 5. Animate Fireworks
                for (let i = fireworks.length - 1; i >= 0; i--) {
                    const fw = fireworks[i];
                    const positions = fw.mesh.geometry.attributes.position.array;
                    fw.life -= 0.02;
                    fw.mesh.material.opacity = fw.life;

                    for(let j=0; j < fw.vel.length/3; j++) {
                        positions[j*3] += fw.vel[j*3];
                        positions[j*3+1] += fw.vel[j*3+1];
                        positions[j*3+2] += fw.vel[j*3+2];
                        // Gravity
                        fw.vel[j*3+1] -= 0.003; 
                    }
                    fw.mesh.geometry.attributes.position.needsUpdate = true;

                    if(fw.life <= 0) {
                        scene.remove(fw.mesh);
                        fireworks.splice(i, 1);
                    }
                }

                renderer.render(scene, camera);
            }
            animate();

            // --- 4. UI LOGIC ---
            // Polling to ensure objects are ready before revealing UI, good fallback
            let checkReady = setInterval(() => {
                if(document.getElementById('loading')) {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('step-1').style.display = 'block';
                    clearInterval(checkReady);
                }
            }, 100);

            function startParty() {
                document.getElementById('bg-music').volume = 0.6;
                document.getElementById('bg-music').play().catch(e=>console.log("Audio blocked"));
                
                document.getElementById('step-1').classList.add('hidden');
                
                // Show Disco Ball
                discoGroup.visible = true;
                discoGroup.scale.set(0,0,0);
                gsap.to(discoGroup.scale, { x:1, y:1, z:1, duration: 1.5, ease: "back.out(1.7)" });

                setTimeout(() => {
                    document.getElementById('step-2').classList.remove('hidden');
                }, 1500);
            }

            function popChampagne() {
                document.getElementById('pop-sound').play().catch(()=>{});
                
                // Hide button
                document.getElementById('step-2').classList.add('hidden');

                // Spawn Particles
                for(let i=0; i<100; i++) {
                    const mesh = new THREE.Mesh(bubbleGeo, bubbleMat);
                    // Start from bottom center
                    mesh.position.set(0, -5, 5); 
                    bubblesGroup.add(mesh);
                    
                    bubbles.push({
                        mesh: mesh,
                        velocity: new THREE.Vector3(
                            (Math.random() - 0.5) * 0.5,
                            0.5 + Math.random() * 0.5,
                            (Math.random() - 0.5) * 0.5
                        ),
                        life: 1.0 + Math.random()
                    });
                }

                // Move camera back slightly
                gsap.to(camera.position, { z: 20, duration: 2 });

                setTimeout(() => {
                    document.getElementById('step-popper').classList.remove('hidden');
                }, 1500);
            }

            function pullPopper() {
                triggerPopper(); // Call visual effect
                document.getElementById('step-popper').classList.add('hidden');
                
                // Wait a bit for confetti, then show countdown
                setTimeout(() => {
                    document.getElementById('step-4').classList.remove('hidden');
                }, 2000);
            }

            function startCountdown() {
                const btn = document.getElementById('btn-countdown');
                btn.style.display = 'none'; // Hide button
                
                const timer = document.getElementById('countdown-timer');
                let count = 10;
                
                const interval = setInterval(() => {
                    count--;
                    timer.textContent = count;
                    gsap.from(timer, { scale: 1.5, opacity: 0.5, duration: 0.5 }); // Pulse effect

                    if(count <= 0) {
                        clearInterval(interval);
                        document.getElementById('step-4').classList.add('hidden');
                        celebrateNewYear();
                    }
                }, 1000);
            }

            function celebrateNewYear() {
                // Hide disco ball or move it up
                gsap.to(discoGroup.position, { y: 5, duration: 2 });

                // Show Final Screen
                const final = document.getElementById('final-screen');
                final.classList.remove('hidden');
                
                // Animate Year Text
                const yearText = document.getElementById('year-display');
                yearText.style.opacity = 1;
                yearText.style.transform = 'scale(1)';
                
                // Show Card
                const card = document.getElementById('card-content');
                card.style.display = 'block';
                gsap.to(card, { opacity: 1, y: 0, scale: 1, duration: 1, delay: 0.5, ease: "back.out" });

                // Loop Fireworks
                setInterval(() => {
                    createFirework();
                    createFirework();
                }, 500);
            }

            function shareExperience() {
                const shareData = {
                    title: 'Happy New Year 2026',
                    text: 'Ring in the New Year with this magical 3D countdown! üéÜ',
                    url: window.location.href
                };
                if(navigator.share) {
                    navigator.share(shareData).catch(err => console.log('Share failed', err));
                } else {
                    navigator.clipboard.writeText(window.location.href);
                    alert("Link copied! Send it to your friends.");
                }
            }

            // Attach listeners
            document.getElementById('btn-start').addEventListener('click', startParty);
            document.getElementById('btn-champagne').addEventListener('click', popChampagne);
            document.getElementById('btn-pull-popper').addEventListener('click', pullPopper);
            document.getElementById('btn-countdown').addEventListener('click', startCountdown);
            document.getElementById('btn-share').addEventListener('click', shareExperience);

            // Resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

        })(); // End self-executing function
    </script>
</body>
</html>
